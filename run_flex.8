.TH run_flex.sh 8 "14 September 2022" "run_flex.sh" "IOCCC tools"
.SH NAME
run_flex.sh \- run flex to generate C code from a *.l file or use backup files if error
.SH SYNOPSIS
\fBrun_flex.sh\fP [\-h] [\-V] [\-v level] [\-o] [\-f flex] [\-l limit_ioccc.sh] [\-g verge] [\-p prefix] [\-s sorry.h] [\-F dir] \-\- [flex_flags]
.SH DESCRIPTION
\fBrun_flex.sh\fP attempts to find a recent enough version of flex (minimum version defined in \fIlimit_ioccc.sh\fP or file specified by \fB\-l\fP option) and use it to generate code from the \fBprefix.l\fP file.
The default prefix is \fIjparse\fP but this script can be used for other scanners as well.
If a recent enough version is not found or flex encounters an error (syntax error or anything else) and the \fB\-o\fP option is not specified, it attempts to use the backup files.
.SH OPTIONS
.TP
\fB\-h\fP
Show help and exit.
.TP
\fB\-V\fP
Show version and exit.
.TP
\fB\-v\fP
Set verbosity level.
.TP
\fB\-o\fP
Do \fBNOT\fP use backup files.
If flex cannot be used or fails to generate the files the script will fail.
.TP
\fB\-f\fP
Specify flex basename.
.TP
\fB\-l\fP
Specify path to version file.
.TP
\fB\-g\fP
Specify path to the \fBverge\fP tool.
This is used to determine if the flex tool is recent enough.
.TP
\fB\-p\fP
Specify prefix of files to use.
The flex input file will be \fIprefix.l\fP.
If the \fB\-o\fP option was not used and flex cannot be used or fails then the backup file \fIprefix.c\fP will be used.
.TP
\fB\-s\fP
File to prepend to the C output.
.TP
\fB\-F\fP
Specify a directory to search for flex in.
\fB\-F\fP can be used more than once.
If not used the script looks at \fB$PATH\fP.
.TP
The \fBflex_flags\fP are any optional flags to give to flex before the prefix.
.SH EXIT STATUS
.PP
    0    flex output files formed or backup files used instead
.br
    1    flex not found or too old and -o used
.br
    2    good flex found and ran but failed to form proper output files
.br
    3    flex input file missing or not readable:         backup file(s) had to be used
.br
    4    backup file(s) are missing, or are not readable
.br
    5    failed to use backup file(s) to form the flex C output file(s)
.br
    6    limit_ioccc.sh or sorry file missing/not readable or verge missing/not executable
.br
    7    MIN_FLEX_VERSION missing or empty from limit_ioccc.sh
.br
    8    -h and help string printed or -V and version string printed
.br
    9    Command line usage error
.br
    >=10  internal error"
.SH NOTES
.PP
The \fB\-o\fP option is mainly for maintainers of the \fBjparse\fP scanner and parser but it can be used to test if you have a recent enough version of flex.
The idea behind it is if flex fails it might indicate a syntax error which the authors of \fBjparse\fP would need to fix.
.PP
Beware that some make implementations have a default rule for \fI*.l\fP files so that if one were to in this repo do:
.nf
.RS
\fB
 touch foo.l
 make\fP
.fi
.RE
.PP
the file \fIfoo.c\fP would be overwritten and cause a compilation error.
This appears to be because foo is actually referenced in the Makefile as a target.
.SH BUGS
.PP
There's no way to disable prepending a file to the generated files.
This should probably be fixed at some point.
.PP
If you have any issues with the tool you can open an issue at \fI\<https://github.com/ioccc-src/mkiocccentry/issues\>\fP.
.SH EXAMPLES
.PP
Run \fBrun_flex.sh\fP with default options, which should attempt to run flex on the \fIjparse.l\fP file:
.nf
.RS
\fB
 ./run_flex.sh\fP
.fi
.RE
.PP
Run \fBrun_flex.sh\fP but specify that backup files are not to be used in case a recent enough version of flex cannot be found or fails for some reason.

.nf
.RS
\fB
 ./run_flex.sh -o\fP
.fi
.RE
.PP
Try and run flex on the file \fIfoobar.l\fP and don't use any backup files:
.nf
.RS
\fB
 ./run_flex.sh -o -p foobar\fP
.fi
.RE
.PP
Try and run flex on the file \fIfoobar.l\fP with lex instead of flex and don't use any backup files:
.nf
.RS
\fB
 ./run_flex.sh -o -p foobar -f lex\fP
.fi
.RE
