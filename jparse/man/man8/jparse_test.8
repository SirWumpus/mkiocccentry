.\" section 8 man page for jparse_test.sh
.\"
.\" This man page was first written by Cody Boone Ferguson for the IOCCC
.\" in 2022.
.\"
.\" Humour impairment is not virtue nor is it a vice, it's just plain
.\" wrong: almost as wrong as JSON spec mis-features and C++ obfuscation! :-)
.\"
.\" "Share and Enjoy!"
.\"     --  Sirius Cybernetics Corporation Complaints Division, JSON spec department. :-)
.\"
.TH jparse_test.sh 8 "28 January 2023" "jparse_test.sh" "IOCCC tools"
.SH NAME
.B jparse_test.sh
\- test jparse on one or more files with one or more one\-line JSON blobs
.SH SYNOPSIS
.B jparse_test.sh
.RB [\| \-h \|]
.RB [\| \-V \|]
.RB [\| \-v
.IR level \|]
.RB [\| \-D
.IR dbg_level \|]
.RB [\| \-J
.IR level \|]
.RB [\| \-q \|]
.RB [\| \-j
.IR jparse \|]
.RB [\| \-d
.IR json_tree \|]
.RB [\| \-s
.IR subdir \|]
.RI [\| file
.IR .. \|]
.SH DESCRIPTION
.B jparse_test.sh
tests each line in each file for valid JSON.
The file name
.I \-
means read from stdin.
At least one file is required.
It also uses 
.B find(1)
to look under the JSON tree for good and bad files that must pass or fail respectively.
The files that must pass are in the subdirectory called 
.I good
and the files that must fail are in the subdirectory called
.I bad\c
\&.
It keeps a log of all the tests in
.I jparse_test.log
for later inspection.
.SH OPTIONS
.TP
.B \-h
Print help and exit.
.TP
.B \-V
Print version and exit.
.TP
.BI \-v\  level
Set verbosity level to
.I level\c
\&.
.TP
.BI \-D\  level
Set debug level to
.I level\c
\&.
.TP
.BI \-J\  level
Set JSON verbosity level to
.I level\c
\&.
.TP
.BI \-q
Set quiet mode.
This will be affect the JSON parser.
.TP
.BI \-j\  jparse
Set path to the JSON parser jparse to
.I jparse\c
\&.
.TP
.BI \-d\  json_tree
Set json tree to look for good and bad files under to
.I json_tree\c
\&.
.TP
.BI \-s\  subdir
Set subdirectory in
.I json_tree
above the
.I good
and
.I bad
directories.
To not specify a subdirectory specify
.I .
(dot) as the directory.
.SH EXIT STATUS
.TP
0
all tests are OK
.TQ
1
at least one test failed
.TQ
2
.B \-h
and help string printed or
.B \-V
and version string printed
.TQ
3
invalid command line
.TQ
4
.B jparse
not a regular executable file
.TQ
5
couldn't create writable log file
.TQ
6
missing directory or directories
.TQ
7
missing JSON file
.TQ
>=10
internal error
.SH FILES
.I json_teststr.txt
.RS
The default file that
.B jparse_test.sh
reads from.
.RE
.I jparse_test.log
.RS
The log file kept by
.B jparse_test.sh\c
\&.
It will be removed prior to each time the script is run to keep the state of the file consistent with the run.
.RE
.I test_JSON
.RS
The default JSON tree with good and bad subdirectories for files that must pass and fail, respectively.
.RE
.SH NOTES
The JSON parser
.B jparse
was co\-developed by Cody Boone Ferguson and Landon Curt Noll (one of the IOCCC Judges) in support for IOCCCMOCK, IOCCC28 and beyond.
.SH BUGS
If you have a problem with the tool (not JSON itself! :\-) ) you can report it at the GitHub issues page.
It can be found at
.br
.I \<https://github.com/ioccc\-src/mkiocccentry/issues\>\c
\&.
.SH SEE ALSO
.B jparse(1)
