.\" section 1 man page for run_bison.sh
.\"
.\" This man page was first written by Cody Boone Ferguson for the IOCCC
.\" in 2022.
.\"
.\" Humour impairment is not virtue nor is it a vice, it's just plain
.\" wrong: almost as wrong as JSON spec mis-features and C++ obfuscation! :-)
.\"
.\" "Share and Enjoy!"
.\"     --  Sirius Cybernetics Corporation Complaints Division, JSON spec department. :-)
.\"
.TH run_bison.sh 8 "28 January 2023" "run_bison.sh" "IOCCC tools"
.SH NAME
.B run_bison.sh
\- run
.B bison
to generate C code from a
.I *.y
file or use backup files if error
.SH SYNOPSIS
.B run_bison.sh
.RB [\| \-h \|]
.RB [\| \-V \|]
.RB [\| \-v
.IR level \|]
.RB [\| \-o \|]
.RB [\| \-b
.IR bison \|]
.RB [\| \-g
.IR verge \|]
.RB [\| \-p
.IR prefix \|]
.RB [\| \-s
.IR sorry.h \|]
.RB [\| \-S \|]
.RB [\| \-B
.IR dir \|]
.RB [\| \-D
.IR dir \|]
.B \-\-
.RI [\| bison_flags \|]
.SH DESCRIPTION
.B run_bison.sh
attempts to find a recent enough version of
.B bison
(minimum version defined in 
.I run_bison.sh\c
\&) and use it to generate code from the
.I prefix.y
file.
The default prefix is 
.I jparse
but this script can be used for other parsers as well.
If a recent enough version is not found or
.B bison
encounters an error (syntax error or anything else) and the 
.B \-o
option is not specified, it attempts to use the backup files
.I prefix.tab.ref.c
and
.I prefix.tab.ref.h\c
\&.
.SH OPTIONS
.TP
.B \-h
print help and exit.
.TP
.B \-V
print version and exit.
.TP
.BI \-v\  level
set verbosity level to
.I level\c
\&.
.TP
.B \-o
do
.B NOT use backup files.
If
.B bison
cannot be used or fails to generate the files the script will fail.
.TP
.BI \-b\  bison
set
.B bison
basename to
.I bison\c
\&.
.TP
.BI \-g\  verge
set path to the
.B verge
tool to
.I verge\c
\&.
This is used to determine if the
.B bison
tool is recent enough.
.TP
.BI \-p\  prefix
set prefix of files to use to
.I prefix\c
\&.
The bison input file will be
.I prefix.y\c
\&.
If the
.B \-o option was not used and bison cannot be used or fails then the backup files
.I prefix.tab.ref.c
and
.I prefix.tab.ref.h
will be used.
.TP
.BI \-s\  sorry.h
set path of file to prepend to the C output to
.I sorry.h\c
\&.
.TP
.B \-S
suppress prepending apology to generated C output files.
.TP
.BI \-B\  bison_dir
add directory
.I bison_dir
to list to search for
.B bison\c
\&.
.B \-B
can be used more than once.
If not used the script looks at
.B $PATH\c
\&.
.TP
.BI \-D\  dir
set directory to find the flex source file in to
.I dir\c
\&.
Default is
.I .
(dot).
.PP
The
.I bison_flags
are any optional flags to give to
.B bison
before the prefix.
.SH EXIT STATUS
.TP
0
.B bison
output files formed or backup files used instead
.TQ
1
.B bison
not found or too old and \-o used
.TQ
2
good
.B bison
found and ran but failed to form proper output files
.TQ
3
.B bison
input file missing or not readable: backup files had to be used
.TQ
4
backup files missing or are not readable
.TQ
5
failed to use backup files to form the
.B bison
C output files
.TQ
6
.I sorry.h
file missing/not readable or
.B verge
missing/not executable
.TQ
7
\-h and help string printed or \-V and version string printed
.TQ
8
command line usage error
.TQ
>=10
internal error
.SH NOTES
.PP
The
.B \-o
option is mainly for maintainers of the
.B jparse
parser and scanner but it can be used to test if you have a recent enough version of
.B bison\c
\&.
The idea behind it is if
.B bison
fails it might indicate a syntax error which the authors of
.B jparse
would need to fix.
.PP
Beware that some make implementations have a default rule for 
.I *.y
files so that if one were to do:
.sp
.RS
.ft B
 touch foo.y
 make
.ft R
.RE
.sp
and 
.I foo.c
is supposed to exist (and not generated by bison) it will likely cause a compilation error until it is replaced with the original file.
Even worse is that until that file is deleted (assuming
.I foo.y
is in error say because it was created by touch and is empty) make will continue to fail.
This assumes that
.B foo
is a target in the Makefile, of course.
.SH BUGS
.PP
If you have any issues with the tool you can open an issue at
.br
.I \<https://github.com/ioccc\-src/mkiocccentry/issues\>\c
\&.
.SH EXAMPLES
.PP
Run
.B run_bison.sh
with default options, which should attempt to run
.B bison
on the
.I jparse.y
file:
.sp
.RS
.ft B
 ./run_bison.sh
.ft R
.RE
.PP
Run
.B run_bison.sh
but specify that backup files are not to be used in case a recent enough version of
.B bison
cannot be found or fails for some reason:
.sp
.RS
.ft B
 ./run_bison.sh \-o
.ft R
.RE
.PP
Try and run
.B bison
on the file
.I foobar.y
and don't use any backup files:
.sp
.RS
.ft B
 ./run_bison.sh \-o \-p foobar
.ft R
.RE
.PP
Try and run
.B bison
on the file
.I foobar.y
with yacc instead of
.B bison
and don't use any backup files:
.sp
.RS
.ft B
 ./run_bison.sh \-o \-p foobar \-b yacc
.ft R
.RE
.SH SEE ALSO
.B run_flex(1)\c
\&,
.B jparse(1) 
