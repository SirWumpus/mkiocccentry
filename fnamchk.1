.TH fnamchk 1 "09 October 2022" "fnamchk" "IOCCC tools"
.SH NAME
fnamchk \- IOCCC compressed tarball filename sanity check tool
.SH SYNOPSIS
\fBfnamchk\fP [\-h] [\-v level] [\-q] [\-V] [\-E ext] [\-t|\-u] filepath
.SH DESCRIPTION
\fBfnamchk\fP verifies that an IOCCC compressed tarball is properly named.
.PP
The program validates that the filename is correct, in the form of \fBentry.contest_ID\-entry_num.timestamp.ext\fP where
\fBcontest_ID\fP is either \fItest\fP or a valid UUID (see below), \fBentry_number\fP is an integer from \fB0\fP through \fBMAX_ENTRY_NUM\fP (see \fIlimit_ioccc.h\fP) inclusive, \fBtimestamp\fP is an integer of the number of seconds since the epoch and \fBext\fP is either \fBtxz\fP or the user supplied extension from the \fB\-E\fP option.
.PP
More specifically, the filename \fBmust\fP:
.PP
.RS
Start with "\fBentry\fP".
.PP
Followed by "\fB.\fP".
.PP
Followed by either "\fBtest\fP" \fIOR\fP a UUID string in the form of \fBxxxxxxxx-xxxx-4xxx-axxx-xxxxxxxxxxxx\fP where \fBx\fP is a hexadecimal digit in the range \fB[0-9a-f]\fP.
And yes, there is a \fB4\fP (UUID version 4) and an \fBa\fP (UUID variant 1) in there.
.PP
Followed by "\fB\-\fP".
.PP
Followed by a decimal entry number from \fB0\fP through \fBMAX_ENTRY_NUM\fP (see \fIlimit_ioccc.h\fP) inclusive.
.PP
Followed by "\fB.\fP".
.PP
Followed by a positive non-zero 64-bit decimal integer.
.PP
Followed by "\fB.\fP".
.PP
Followed by "\fBtxz\fP" (or the user supplied extension from option \fB\-E\fP).
.RE
.PP
NOTE: The quotes above should not be in the filename; they're there only to help distinguish the punctuation from the rest of the format.
.PP
It is indirectly invoked via the \fBtxzchk(1)\fP utility which is called by \fBmkiocccentry(1)\fP and it will also be directly executed by the Judges during the judging process of the contests.
.SH OPTIONS
.TP
\fB\-h\fP
Show help and exit.
.TP
\fB\-v \fIlevel\fP\fP
Set verbosity level.
Default: 0.
.TP
\fB\-V\fP
Show version and exit.
.TP
\fB\-q\fP
Quiet mode.
Silence msg(), warn(), warnp() if verbosity level is 0.
Default: \fBfalse\fP.
.TP
\fB\-E \fIext\fP\fP
Change extension to extension specified (without the dot!).
This is used for \fBTESTING\fP purposes only!
.TP
\fB\-t\fP
If the filename does not start with the test mode filename format, issue an error.
In other words the filename has to start with \fIentry.test-\fP or it's an error.
.TP
\fB\-u\fP
If the filename does not start with the normal filename format, issue an error.
In other words if the filename starts with \fIentry.test-\fP it is an error.
.SH EXIT STATUS
.PP
\fBmain()\fP returns 0 on success; if there's an error the end is not reached.
If there is an error the error message is printed prior to exiting; else the output will be the name of the required directory in the tarball (this is used by \fBtxzchk(1)\fP).
.SH BUGS
.PP
More than 0 humans work on it! :)
.PP
If you have an issue with the tool you can open an issue at \fI\<https://github.com/ioccc-src/mkiocccentry/issues\>\fP.
.SH EXAMPLES
.PP
.nf
Run the program on the filename \fIentry.test-0.1562145368.txz\fP which will fail because the current timestamp is a larger value:

.RS
\fB
 ./fnamchk -t entry.test-0.1562145368.txz\fP.
.fi
.RE
.PP
.nf
Run the program on the filename \fItest.tar\fP, which will fail because the name format is invalid:

.RS
\fB
 ./fnamchk test.tar\fP
.fi
.RE
.PP
Note that the below example filenames are based on the current minimum timestamp which is \fB(time_t)1662145368\fP.
When this value changes the examples below will fail the test of the minimum timestamp if they're not updated.
When one updates the minimum timestamp one should also update the references to it to the new value in this man page or else the examples will break.
.PP
.nf
Run the program on the filename \fIentry.test.0.1662145368.txz\fP with the option \fI\-u\fP which will fail:

.RS
\fB
 ./fnamchk -u entry.test-0.1662145368.txz\fP
.fi
.RE
.PP
.nf
Run the program on the filename \fIentry.test.0.1662145368.txz\fP with the option \fI\-t\fP which will pass:

.RS
\fB
 ./fnamchk -t entry.test-0.1662145368.txz\fP
.fi
.RE
.PP
The above will print "\fBtest\-0\fP".
.PP
.nf
Run the program on the file \fIentry.test.0.1662145368.txt\fP with the option \fI\-t\fP which will pass:

.RS
\fB
 ./fnamchk -E txt -t entry.test-0.1662145368.txt\fP
.fi
.RE
.PP
The above will print "\fBtest\-0\fP".
.PP
.nf
Run the program on the file \fIentry.test.0.1662145368.txz\fP with the options \fI\-t\fP and \fI\-E txt\fP which will fail:

.RS
\fB
 ./fnamchk -E txt -t entry.test-0.1662145368.txz\fP
.fi
.RE
