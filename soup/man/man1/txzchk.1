.\" section 1 man page for txzchk
.\"
.\" This man page was first written by Cody Boone Ferguson for the IOCCC
.\" in 2022.
.\"
.\" txzchk was written by Cody Boone Ferguson.
.\"
.\" Dedicated to:
.\"
.\"	The many poor souls who have been tarred and feathered:
.\"
.\"	    "Because sometimes people throw feathers on tar." :-(
.\"
.\"	And to my wonderful Mum and my dear cousin and friend Dani:
.\"
.\"	    "Because even feathery balls of tar need some love.: :-)
.\"
.\" Humour impairment is not virtue nor is it a vice, it's just plain
.\" wrong: almost as wrong as JSON spec mis-features and C++ obfuscation! :-)
.\"
.\" When you're playing with tar and you run you might trip and fall into a
.\" tar pit. And if it's Hallowe'en you might be running from a ghost or vampire
.\" or some kind of monster. :\-) That's why you should use txzchk(1): to make sure
.\" you won't get stuck in tar! :\-)
.\"
.\" "Share and Enjoy!"
.\"     --  Sirius Cybernetics Corporation Complaints Division, JSON spec department. :-)
.\"
.TH txzchk 1 "28 January 2023" "txzchk" "IOCCC tools"
.SH NAME
.B txzchk
\- sanity checker tool used on IOCCC compressed tarballs
.SH SYNOPSIS
.B txzchk
.RB [\| \-h \|]
.RB [\| \-v
.IR level \|]
.RB [\| \-q \|]
.RB [\| \-w \|]
.RB [\| \-V \|]
.RB [\| \-t
.IR tar \|]
.RB [\| \-F
.IR fnamchk \|]
.RB [\| \-T \|]
.RB [\| \-E
.IR ext \|]
.I tarball_path
.SH DESCRIPTION
.B txzchk
runs a series of sanity tests on IOCCC compressed tarballs.
It is invoked by 
.B mkiocccentry(1)
after the tarball is formed, reporting any feathers stuck in the tarball (i.e. issues found) and exiting the program accordingly; if
.B txzchk
does not return 0,
.B mkiocccentry
will exit with an error.
.PP
The program runs 
.B tar \-tJvf
on the 
.B tarball_path
and parses the output of the command, performing a variety of tests on the tarball.
As a side effect it will show the user the contents of the tarball.
The tarball is 
.B NOT
extracted.
.B txzchk
also runs the IOCCC tool 
.B fnamchk(1)
on the file, verifying that the tarball is properly named (this is also how it gets the directory name that the files should be in).
.PP
In other words it makes sure that
.B mkiocccentry(1)
was used and that there was no screwing around with the resultant tarball.
As an important part of the judging process, the Judges will directly execute this tool on every entry's tarball.
.SH OPTIONS
.TP
.B \-h
Show help and exit.
.TP
.BI \-v\  level
Set verbosity level.
.TP
.B \-q
Suppresses some of the output.
Errors and the output of the
.B tar
command are still shown.
If you need to see warnings with this option, use
.B -w\c
\&.
.TP
.B \-w
Always show warnings.
This is used in the
.B txzchk_test(8)
script because it must see the warnings.
.TP
.B \-V
Show version and exit.
.TP
.BI \-t\  tar
Set path to
.B tar(1)
to
.I tar\c
\&.
It must accept the
.B \-J
option.
.B txzchk
checks
.I /usr/bin/tar
and
.I /bin/tar
if this option is not specified.
.TP
.BI \-F\  fnamchk
Set path to the IOCCC
.B fnamchk(1)
tool to
.I fnamchk\c
\&.
If this option is not specified the program looks under the current working directory and
.I /usr/local/bin\c
\&.
.TP
.B \-T
Assume tarball_path is a text file: use
.B fopen(3)
and
.B fclose(3)
instead of
.B popen(3)
and
.B pclose(3)
and don't require
.B tar
program.
.TP
.BI \-E\  ext
Change extension for
.B fnamchk(1)
to validate (don't include the dot).
This is used in conjunction with
.B \-T
above for 
.B TESTING
purposes only!
.SH EXIT STATUS
.TP
0
no feathers stuck in tarball  :\-)
.TQ
1
tarball was successfully parsed :\-) but there's at least one feather stuck in it  :\-(
.TQ
2
.B \-h
and help string printed or
.B \-V
and version string printed
.TQ
3
invalid command line, invalid option or option missing an argument
.TQ
>= 10
internal error has occurred or unknown tar listing format has been encountered
.SH NOTES
.PP
This tool was written by
.B Cody Boone Ferguson
for the 
.B IOCCC Judges
in early 2022 for the
.B IOCCCMOCK\c
\&,
.B IOCCC28
and all future
.B IOCCC
competitions after discussing the requirements with 
.B Landon Curt Noll\c
\&, one of the IOCCC Judges.
For more history see 
.B txzchk(1)\c
\&,
.B CHANGES.md\
\&,
.B README.md\c
\&, the GitHub git log and of course reading the source itself.
.PP
No pitman or coal mines were harmed in the making of this tool and neither were any pine trees or birch trees.
Whether the fact no coal mines were harmed is a good or bad thing might be debatable but nevertheless none were harmed. :\-)
More importantly, no tar pits \- including the 
.B La Brea Tar Pits
\- were disturbed in the making of this tool. :\-)
.SH BUGS
.PP
There are no issues, there are only feathers! :\-)
.PP
(Well, okay: Cody Boone Ferguson wrote it! :) )
.PP
On a more serious note, if you have an issue with the tool please report it at the GitHub issues page.
You can find it at
.br
.I <https://github.com/ioccc\-src/mkiocccentry/issues>\c
\&.
If you would please mention 
.B @xexyl
as part of the report that would be appreciated.
.SH EXAMPLES
.PP
Run the program on the tarball 
.I entry.test\-1.1644094311.txz\c
\&:
.sp
.RS
.ft B
 ./txzchk entry.test\-1.1644094311.txz
.ft R
.RE
.PP
Run the program on the tarball 
.I entry.test\-1.1644094311.txz\c
\&, specifying an alternate path to 
.B tar
and
.B fnamchk\c
\&:
.sp
.RS
.ft B
 ./txzchk \-t /path/to/some/tar \-F ./filenamechk entry.test\-1.1644094311.txz
.ft R
.RE
.PP
Run the program on the file
.I entry.test\-1.1644094311.txt\c
\&, specifying that it's a text file (which means 
.B \-T
and
.B \-E
have to be used):
.sp
.RS
.ft B
 ./txzchk \-T \-E txt entry.test\-1.1644094311.txt
.ft R
.RE
.SH SEE ALSO
.PP
The IOCCC tools
.B txzchk(1)\c
\&, the test suite
.B txzchk_test(8)\c
\&,
.B fnamchk(1)
and
.B mkiocccentry(1)\c
\&.
.br
The tarry
.B tar(1)
command itself.
.br
And don't forget the very tarry
.B La Brea Tar Pits\c
\&:
.I <https://tarpits.org>\c
\&
